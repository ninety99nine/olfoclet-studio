import{s as k,e as r,a as t,t as g,b as a,w as i,f as p,x as l,o,g as d,F as u,c as m,i as b,n as h}from"./app-de0467f4.js";import{_ as j,a as $}from"./TextInput-ffd0ded0.js";import{_ as C}from"./InputLabel-ee6d9ab7.js";import{J as T}from"./Textarea-60aeda79.js";import{_ as V}from"./PrimaryButton-59c7c447.js";import{J as E}from"./SelectInput-9be824b1.js";import{a as O}from"./DialogModal-0bcc6872.js";import{_ as B}from"./DangerButton-3a48bd47.js";import{_ as J}from"./ActionMessage-b457393f.js";import{_ as D}from"./SecondaryButton-bd720716.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const P=k({components:{JetLabel:C,JetInput:j,JetTextarea:T,JetButton:V,JetInputError:$,JetSelectInput:E,JetDialogModal:O,JetSecondaryButton:D,JetActionMessage:J,JetDangerButton:B},props:{action:{type:String,default:"update"},modelValue:{type:Boolean,default:!1},showAddbutton:{type:Boolean,default:!1},subscription:{type:Object,default:null},subscriptionPlans:Array,show:{type:Boolean,default:!1}},data(){return{form:null,showModal:this.modelValue,showSuccessMessage:!1,showErrorMessage:!1}},watch:{showModal:{handler:function(e,s){e!=this.modelValue&&this.$emit("update:modelValue",e)}},modelValue:{handler:function(e,s){e!=this.showModal&&(this.showModal=e,this.reset())}}},computed:{hasSubscription(){return this.subscription!=null},wantsToUpdate(){return!!(this.hasSubscription&&this.action=="update")},wantsToDelete(){return!!(this.hasSubscription&&this.action=="delete")},subscriptionPlanOptions(){return this.subscriptionPlans.map(function(e){return{name:e.name,value:e.id}})}},methods:{openModal(){this.showModal=!0},closeModal(){this.showModal=!1},create(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.post(route("create-subscription",{project:route().params.project}),e)},update(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.put(route("update-subscription",{project:route().params.project,subscription:this.subscription.id}),e)},destroy(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.delete(route("delete-subscription",{project:route().params.project,subscription:this.subscription.id}),e)},handleOnSuccess(){this.reset(),this.closeModal(),this.showSuccessMessage=!0,setTimeout(()=>{this.showSuccessMessage=!1},3e3)},handleOnError(){this.showErrorMessage=!0,setTimeout(()=>{this.showErrorMessage=!1},3e3)},reset(){this.form=this.$inertia.form({msisdn:this.hasSubscription?this.subscription.subscriber.msisdn:null,subscription_plan_id:this.hasSubscription?this.subscription.subscription_plan_id:this.subscriptionPlanOptions.length?this.subscriptionPlanOptions[0].value:null})}},created(){this.reset()}}),A={key:0,class:"grid grid-cols-2 gap-4"},L={class:"bg-gray-50 pt-3 pl-6 border-b rounded-t"},N={class:"text-sm text-gray-500 my-2"},z=t("span",{class:"font-bold mr-2"},"GET / POST:",-1),I={class:"text-green-500 font-semibold"},F=t("div",{class:"clear-both"},null,-1),G={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-6",role:"alert"},q={key:0,class:"font-bold"},H={key:1,class:"font-bold"},K={key:2,class:"font-bold"},Q=t("svg",{class:"fill-current h-6 w-6 text-green-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("title",null,"Close"),t("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1),R=[Q],W={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6",role:"alert"},X={key:0,class:"font-bold"},Y={key:1,class:"font-bold"},Z={key:2,class:"font-bold"},x=t("svg",{class:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("title",null,"Close"),t("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1),ee=[x],se=t("span",{class:"block mt-6 mb-6"},"Are you sure you want to delete this subscription?",-1),te={class:"text-sm text-gray-500"},oe={class:"mb-4"},re={class:"mb-4"};function ne(e,s,ae,ie,le,de){const c=l("jet-button"),f=l("jet-label"),w=l("jet-input"),_=l("jet-input-error"),y=l("jet-select-input"),S=l("jet-secondary-button"),v=l("jet-danger-button"),M=l("jet-dialog-modal");return o(),r("div",null,[e.$inertia.page.props.projectPermissions.includes("Manage subscriptions")&&e.showAddbutton?(o(),r("div",A,[t("div",L,[t("div",N,[z,t("span",I,g(e.route("api.create.subscription",{project:e.route().params.project})),1)])]),t("div",null,[a(c,{onClick:s[0]||(s[0]=n=>e.openModal()),class:"float-right w-fit"},{default:i(()=>[d(" Add Subscription ")]),_:1}),F])])):p("",!0),t("div",null,[e.showSuccessMessage?(o(),r("div",G,[e.wantsToUpdate?(o(),r("strong",q,"Subscription updated successfully")):e.wantsToDelete?(o(),r("strong",H,"Subscription deleted successfully")):(o(),r("strong",K,"Subscription created successfully")),t("span",{onClick:s[1]||(s[1]=n=>e.showSuccessMessage=!1),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},R)])):p("",!0),e.showErrorMessage?(o(),r("div",W,[e.wantsToUpdate?(o(),r("strong",X,"Subscription update failed")):e.wantsToDelete?(o(),r("strong",Y,"Subscription delete failed")):(o(),r("strong",Z,"Subscription creation failed")),t("span",{onClick:s[2]||(s[2]=n=>e.showSuccessMessage=!1),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},ee)])):p("",!0),a(M,{show:e.showModal,closeable:!1},{title:i(()=>[e.wantsToUpdate?(o(),r(u,{key:0},[d("Update Subscription")],64)):e.wantsToDelete?(o(),r(u,{key:1},[d("Delete Subscription")],64)):(o(),r(u,{key:2},[d("Add Subscription")],64))]),content:i(()=>[e.wantsToDelete?(o(),r(u,{key:0},[se,t("p",te,g(e.subscription.subscriber.msisdn),1)],64)):(o(),r(u,{key:1},[t("div",oe,[a(f,{for:"msisdn",value:"Mobile"}),a(w,{id:"msisdn",type:"text",class:"mt-1 block w-full",modelValue:e.form.msisdn,"onUpdate:modelValue":s[3]||(s[3]=n=>e.form.msisdn=n),placeholder:"26772000001"},null,8,["modelValue"]),a(_,{message:e.form.errors.msisdn,class:"mt-2"},null,8,["message"])]),t("div",re,[a(f,{for:"subscription-plan",value:"Subscription Plan",class:"mb-1"}),a(y,{placeholder:"Select subscription plan",options:e.subscriptionPlanOptions,modelValue:e.form.subscription_plan_id,"onUpdate:modelValue":s[4]||(s[4]=n=>e.form.subscription_plan_id=n)},null,8,["options","modelValue"]),a(_,{message:e.form.errors.subscription_plan_id,class:"mt-2"},null,8,["message"])])],64))]),footer:i(()=>[a(S,{onClick:s[5]||(s[5]=n=>e.closeModal()),class:"mr-2"},{default:i(()=>[d(" Cancel ")]),_:1}),e.hasSubscription?p("",!0):(o(),m(c,{key:0,onClick:s[6]||(s[6]=b(n=>e.create(),["prevent"])),class:h({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:i(()=>[d(" Create ")]),_:1},8,["class","disabled"])),e.wantsToUpdate?(o(),m(c,{key:1,onClick:s[7]||(s[7]=b(n=>e.update(),["prevent"])),class:h({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:i(()=>[d(" Update ")]),_:1},8,["class","disabled"])):p("",!0),e.wantsToDelete?(o(),m(v,{key:2,onClick:s[8]||(s[8]=b(n=>e.destroy(),["prevent"])),class:h({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:i(()=>[d(" Delete ")]),_:1},8,["class","disabled"])):p("",!0)]),_:1},8,["show"])])])}const Se=U(P,[["render",ne]]);export{Se as default};
