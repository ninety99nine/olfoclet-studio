import u from"./ManageSubscriberModal-2fceff8f.js";import{P as g}from"./Pagination-54faa811.js";import{s as x,e as o,b as l,a as t,F as y,h as _,f as i,x as c,o as n,t as a,i as p}from"./app-8047a45c.js";import{h as f}from"./moment-fbc5633a.js";import{_ as w}from"./_plugin-vue_export-helper-c27b6911.js";import"./TextInput-bc6cbde4.js";import"./InputLabel-22fd5c5c.js";import"./PrimaryButton-8efc2419.js";import"./SelectInput-b01ea32e.js";import"./DialogModal-0a229599.js";import"./DangerButton-569cea3a.js";import"./ActionMessage-cac46d31.js";import"./SecondaryButton-bd238173.js";const b=x({components:{CreateSubscriberModal:u,Pagination:g},props:{totalMessages:Number,subscribersPayload:Object},data(){return{refreshContentInterval:null,isShowingModal:!1,modalAction:null,subscriber:null,moment:f}},methods:{refreshContent(){this.$inertia.reload()},getLastSubscriptionDate(e){return e.length?this.moment(e[0].created_at).fromNow():"..."},getLastMessageDate(e){return e.length?this.moment(e[0].pivot.created_at).fromNow():"..."},getPercentageOfCoverage(e){return this.totalMessages>0?Math.round(e/this.totalMessages*100):0},showModal(e,r){this.subscriber=e,this.modalAction=r,this.isShowingModal=!0},cleanUp(){clearInterval(this.refreshContentInterval),this.refreshContentInterval=null}},created(){this.refreshContentInterval=setInterval(function(){this.refreshContent()}.bind(this),3e3)},unmounted(){this.cleanUp()}}),v={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},k={class:"flex flex-col"},M={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},C={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},P={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},S={class:"min-w-full divide-y divide-gray-200"},$=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"w-1/2 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Mobile")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Subscriptions")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap"},[t("span",null,"Last Subscription")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Messages")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Percentage")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap"},[t("span",null,"Last Message")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Created")]),t("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Actions")])])],-1),D={class:"bg-white divide-y divide-gray-200"},L={class:"px-6 py-4 whitespace-nowrap"},N={class:"text-sm text-gray-900"},I={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center"},V={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},A={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center"},j={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center"},B={class:"text-lg text-green-600"},O={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},U={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},E={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},F=["onClick"],q=["onClick"],z={key:0},G=t("td",{colspan:8,class:"px-6 py-4 whitespace-nowrap"},[t("div",{class:"text-center text-gray-900 text-sm p-6"},"No subscribers")],-1),H=[G];function J(e,r,K,Q,R,T){const d=c("create-subscriber-modal"),m=c("pagination");return n(),o("div",null,[l(d,{modelValue:e.isShowingModal,"onUpdate:modelValue":r[0]||(r[0]=s=>e.isShowingModal=s),action:e.modalAction,subscriber:e.subscriber},null,8,["modelValue","action","subscriber"]),t("div",v,[t("div",k,[t("div",M,[t("div",C,[t("div",P,[t("table",S,[$,t("tbody",D,[(n(!0),o(y,null,_(e.subscribersPayload.data,s=>(n(),o("tr",{key:s.id},[t("td",L,[t("div",N,a(s.msisdn),1)]),t("td",I,a(s.subscriptions_count),1),t("td",V,a(e.getLastSubscriptionDate(s.latest_subscription)),1),t("td",A,a(s.messages_count),1),t("td",j,[t("span",B,a(e.getPercentageOfCoverage(s.messages_count))+"%",1)]),t("td",O,a(e.getLastMessageDate(s.latest_message)),1),t("td",U,a(s.created_at==null?"...":e.moment(s.created_at).format("lll")),1),t("td",E,[e.$inertia.page.props.projectPermissions.includes("Manage subscribers")?(n(),o("a",{key:0,href:"#",onClick:p(h=>e.showModal(s,"update"),["prevent"]),class:"text-indigo-600 hover:text-indigo-900 mr-3"},"Edit",8,F)):i("",!0),e.$inertia.page.props.projectPermissions.includes("Manage subscribers")?(n(),o("a",{key:1,href:"#",onClick:p(h=>e.showModal(s,"delete"),["prevent"]),class:"text-red-600 hover:text-red-900"},"Delete",8,q)):i("",!0)])]))),128)),e.subscribersPayload.data.length==0?(n(),o("tr",z,H)):i("",!0)])])])])])]),l(m,{class:"mt-6",paginationPayload:e.subscribersPayload,updateData:["subscribersPayload"]},null,8,["paginationPayload"])])])}const ct=w(b,[["render",J]]);export{ct as default};
