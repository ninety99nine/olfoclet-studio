import{s as M,e as r,a as o,t as _,b as l,w as i,f as p,x as u,o as t,g as a,F as c,c as m,i as b,n as h}from"./app-5bb89648.js";import{_ as j,a as $}from"./TextInput-520e81fe.js";import{_ as C}from"./InputLabel-c6167a2b.js";import{J as T}from"./Textarea-30ad1ddc.js";import{_ as E}from"./PrimaryButton-8f2ab614.js";import{J as O}from"./SelectInput-ffb88178.js";import{a as V}from"./DialogModal-1ac4e177.js";import{_ as U}from"./DangerButton-e29447dd.js";import{_ as B}from"./ActionMessage-6bee4251.js";import{_ as J}from"./SecondaryButton-d3e600d6.js";import{_ as D}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css            */const P=M({components:{JetLabel:C,JetInput:j,JetTextarea:T,JetButton:E,JetInputError:$,JetSelectInput:O,JetDialogModal:V,JetSecondaryButton:J,JetActionMessage:B,JetDangerButton:U},props:{action:{type:String,default:"update"},modelValue:{type:Boolean,default:!1},showAddbutton:{type:Boolean,default:!1},subscription:{type:Object,default:null},subscriptionPlans:Array,show:{type:Boolean,default:!1}},data(){return{form:null,showModal:this.modelValue,showSuccessMessage:!1,showErrorMessage:!1}},watch:{showModal:{handler:function(e,s){e!=this.modelValue&&this.$emit("update:modelValue",e)}},modelValue:{handler:function(e,s){e!=this.showModal&&(this.showModal=e,this.reset())}}},computed:{hasSubscription(){return this.subscription!=null},hasSubscriber(){return this.hasSubscription&&this.subscription.subscriber!=null},wantsToUpdate(){return!!(this.hasSubscription&&this.action=="update")},wantsToDelete(){return!!(this.hasSubscription&&this.action=="delete")},subscriptionPlanOptions(){return this.subscriptionPlans.map(function(e){return{name:e.name,value:e.id}})}},methods:{openModal(){this.showModal=!0},closeModal(){this.showModal=!1},create(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.post(route("create.subscription",{project:route().params.project}),e)},update(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.put(route("update.subscription",{project:route().params.project,subscription:this.subscription.id}),e)},cancel(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.post(route("cancel.subscription",{project:route().params.project,subscription:this.subscription.id}),e)},uncancel(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.post(route("uncancel.subscription",{project:route().params.project,subscription:this.subscription.id}),e)},destroy(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.delete(route("delete.subscription",{project:route().params.project,subscription:this.subscription.id}),e)},handleOnSuccess(){this.reset(),this.closeModal(),this.showSuccessMessage=!0,setTimeout(()=>{this.showSuccessMessage=!1},3e3)},handleOnError(){this.showErrorMessage=!0,setTimeout(()=>{this.showErrorMessage=!1},3e3)},reset(){this.form=this.$inertia.form({msisdn:this.hasSubscriber?this.subscription.subscriber.msisdn??null:null,cancelled_at:this.hasSubscriber?this.subscription.cancelled_at:null,subscription_plan_id:this.hasSubscription?this.subscription.subscription_plan_id:this.subscriptionPlanOptions.length?this.subscriptionPlanOptions[0].value:null})}},created(){this.reset()}}),A={key:0,class:"grid grid-cols-2 mb-6 gap-4"},L={class:"bg-gray-50 pt-4 pl-6 border-b rounded-t"},N=o("div",{class:"text-2xl font-semibold leading-6 text-gray-500 border-b pb-4 mb-4"},"Subscriptions",-1),z={class:"text-sm text-gray-500 my-2"},I=o("span",{class:"font-bold mr-2"},"GET / POST:",-1),F={class:"text-green-500 font-semibold"},G=o("div",{class:"clear-both"},null,-1),q={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-6",role:"alert"},H={key:0,class:"font-bold"},K={key:1,class:"font-bold"},Q={key:2,class:"font-bold"},R=o("svg",{class:"fill-current h-6 w-6 text-green-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[o("title",null,"Close"),o("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1),W=[R],X={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6",role:"alert"},Y={key:0,class:"font-bold"},Z={key:1,class:"font-bold"},x={key:2,class:"font-bold"},ee=o("svg",{class:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[o("title",null,"Close"),o("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1),se=[ee],te=o("span",{class:"block mt-6 mb-6"},"Are you sure you want to delete this subscription?",-1),oe={class:"text-sm text-gray-500"},re={class:"mb-4"},ne={class:"mb-4"};function ie(e,s,ae,le,pe,ue){const d=u("jet-button"),f=u("jet-label"),S=u("jet-input"),g=u("jet-input-error"),w=u("jet-select-input"),v=u("jet-secondary-button"),y=u("jet-danger-button"),k=u("jet-dialog-modal");return t(),r("div",null,[e.$inertia.page.props.projectPermissions.includes("Manage subscriptions")&&e.showAddbutton?(t(),r("div",A,[o("div",L,[N,o("div",z,[I,o("span",F,_(e.route("api.create.subscription",{project:e.route().params.project})),1)])]),o("div",null,[l(d,{onClick:s[0]||(s[0]=n=>e.openModal()),class:"float-right w-fit"},{default:i(()=>[a(" Add Subscription ")]),_:1}),G])])):p("",!0),o("div",null,[e.showSuccessMessage?(t(),r("div",q,[e.wantsToUpdate?(t(),r("strong",H,"Subscription updated successfully")):e.wantsToDelete?(t(),r("strong",K,"Subscription deleted successfully")):(t(),r("strong",Q,"Subscription created successfully")),o("span",{onClick:s[1]||(s[1]=n=>e.showSuccessMessage=!1),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},W)])):p("",!0),e.showErrorMessage?(t(),r("div",X,[e.wantsToUpdate?(t(),r("strong",Y,"Subscription update failed")):e.wantsToDelete?(t(),r("strong",Z,"Subscription delete failed")):(t(),r("strong",x,"Subscription creation failed")),o("span",{onClick:s[2]||(s[2]=n=>e.showSuccessMessage=!1),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},se)])):p("",!0),l(k,{show:e.showModal,closeable:!1},{title:i(()=>[e.wantsToUpdate?(t(),r(c,{key:0},[a("Update Subscription")],64)):e.wantsToDelete?(t(),r(c,{key:1},[a("Delete Subscription")],64)):(t(),r(c,{key:2},[a("Add Subscription")],64))]),content:i(()=>[e.wantsToDelete?(t(),r(c,{key:0},[te,o("p",oe,_(e.hasSubscriber?e.subscription.subscriber.msisdn:"Unknown"),1)],64)):(t(),r(c,{key:1},[o("div",re,[l(f,{for:"msisdn",value:"Mobile"}),l(S,{id:"msisdn",type:"text",class:"w-full mt-1 block",modelValue:e.form.msisdn,"onUpdate:modelValue":s[3]||(s[3]=n=>e.form.msisdn=n),placeholder:"26772000001"},null,8,["modelValue"]),l(g,{message:e.form.errors.msisdn,class:"mt-2"},null,8,["message"])]),o("div",ne,[l(f,{for:"subscription-plan",value:"Subscription Plan",class:"mb-1"}),l(w,{id:"subscription-plan",placeholder:"Select subscription plan",options:e.subscriptionPlanOptions,modelValue:e.form.subscription_plan_id,"onUpdate:modelValue":s[4]||(s[4]=n=>e.form.subscription_plan_id=n)},null,8,["options","modelValue"]),l(g,{message:e.form.errors.subscription_plan_id,class:"mt-2"},null,8,["message"])])],64))]),footer:i(()=>[l(v,{onClick:s[5]||(s[5]=n=>e.closeModal()),class:"mr-2"},{default:i(()=>[a(" Close ")]),_:1}),e.hasSubscription?p("",!0):(t(),m(d,{key:0,onClick:s[6]||(s[6]=b(n=>e.create(),["prevent"])),class:h({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:i(()=>[a(" Create ")]),_:1},8,["class","disabled"])),e.wantsToUpdate&&e.form.cancelled_at==null?(t(),m(d,{key:1,onClick:s[7]||(s[7]=b(n=>e.cancel(),["prevent"])),class:h([{"opacity-25":e.form.processing},"mr-2"]),disabled:e.form.processing},{default:i(()=>[a(" Cancel ")]),_:1},8,["class","disabled"])):p("",!0),e.wantsToUpdate&&e.form.cancelled_at!=null?(t(),m(d,{key:2,onClick:s[8]||(s[8]=b(n=>e.uncancel(),["prevent"])),class:h([{"opacity-25":e.form.processing},"mr-2"]),disabled:e.form.processing},{default:i(()=>[a(" Uncancel ")]),_:1},8,["class","disabled"])):p("",!0),e.wantsToUpdate?(t(),m(d,{key:3,onClick:s[9]||(s[9]=b(n=>e.update(),["prevent"])),class:h({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:i(()=>[a(" Update ")]),_:1},8,["class","disabled"])):p("",!0),e.wantsToDelete?(t(),m(y,{key:4,onClick:s[10]||(s[10]=b(n=>e.destroy(),["prevent"])),class:h({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:i(()=>[a(" Delete ")]),_:1},8,["class","disabled"])):p("",!0)]),_:1},8,["show"])])])}const ke=D(P,[["render",ie]]);export{ke as default};
