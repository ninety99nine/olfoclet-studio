import{s as k,e as r,a as t,t as _,b as a,w as i,f as d,x as l,o,g as u,F as p,c as m,i as b,n as h}from"./app-8047a45c.js";import{_ as j,a as $}from"./TextInput-bc6cbde4.js";import{_ as T}from"./InputLabel-22fd5c5c.js";import{J as V}from"./Textarea-93bc0975.js";import{_ as C}from"./PrimaryButton-8efc2419.js";import{J as E}from"./SelectInput-b01ea32e.js";import{a as O}from"./DialogModal-0a229599.js";import{_ as B}from"./DangerButton-569cea3a.js";import{_ as J}from"./ActionMessage-cac46d31.js";import{_ as D}from"./SecondaryButton-bd238173.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const P=k({components:{JetLabel:T,JetInput:j,JetTextarea:V,JetButton:C,JetInputError:$,JetSelectInput:E,JetDialogModal:O,JetSecondaryButton:D,JetActionMessage:J,JetDangerButton:B},props:{action:{type:String,default:"update"},modelValue:{type:Boolean,default:!1},showAddbutton:{type:Boolean,default:!1},subscription:{type:Object,default:null},subscriptionPlans:Array,show:{type:Boolean,default:!1}},data(){return{form:null,showModal:this.modelValue,showSuccessMessage:!1,showErrorMessage:!1}},watch:{showModal:{handler:function(s,e){s!=this.modelValue&&this.$emit("update:modelValue",s)}},modelValue:{handler:function(s,e){s!=this.showModal&&(this.showModal=s,this.reset())}}},computed:{hasSubscription(){return this.subscription!=null},hasSubscriber(){return this.hasSubscription&&this.subscription.subscriber!=null},wantsToUpdate(){return!!(this.hasSubscription&&this.action=="update")},wantsToDelete(){return!!(this.hasSubscription&&this.action=="delete")},subscriptionPlanOptions(){return this.subscriptionPlans.map(function(s){return{name:s.name,value:s.id}})}},methods:{openModal(){this.showModal=!0},closeModal(){this.showModal=!1},create(){var s={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:e=>{this.handleOnSuccess()},onError:e=>{this.handleOnError()}};this.form.post(route("create.subscription",{project:route().params.project}),s)},update(){var s={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:e=>{this.handleOnSuccess()},onError:e=>{this.handleOnError()}};this.form.put(route("update.subscription",{project:route().params.project,subscription:this.subscription.id}),s)},destroy(){var s={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:e=>{this.handleOnSuccess()},onError:e=>{this.handleOnError()}};this.form.delete(route("delete.subscription",{project:route().params.project,subscription:this.subscription.id}),s)},handleOnSuccess(){this.reset(),this.closeModal(),this.showSuccessMessage=!0,setTimeout(()=>{this.showSuccessMessage=!1},3e3)},handleOnError(){this.showErrorMessage=!0,setTimeout(()=>{this.showErrorMessage=!1},3e3)},reset(){this.form=this.$inertia.form({msisdn:this.hasSubscriber?this.subscription.subscriber.msisdn??null:null,subscription_plan_id:this.hasSubscription?this.subscription.subscription_plan_id:this.subscriptionPlanOptions.length?this.subscriptionPlanOptions[0].value:null})}},created(){this.reset()}}),A={key:0,class:"grid grid-cols-2 gap-4"},L={class:"bg-gray-50 pt-3 pl-6 border-b rounded-t"},N={class:"text-sm text-gray-500 my-2"},z=t("span",{class:"font-bold mr-2"},"GET / POST:",-1),I={class:"text-green-500 font-semibold"},F=t("div",{class:"clear-both"},null,-1),G={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-6",role:"alert"},q={key:0,class:"font-bold"},H={key:1,class:"font-bold"},K={key:2,class:"font-bold"},Q=t("svg",{class:"fill-current h-6 w-6 text-green-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("title",null,"Close"),t("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1),R=[Q],W={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6",role:"alert"},X={key:0,class:"font-bold"},Y={key:1,class:"font-bold"},Z={key:2,class:"font-bold"},x=t("svg",{class:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("title",null,"Close"),t("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1),ss=[x],es=t("span",{class:"block mt-6 mb-6"},"Are you sure you want to delete this subscription?",-1),ts={class:"text-sm text-gray-500"},os={class:"mb-4"},rs={class:"mb-4"};function ns(s,e,as,is,ls,us){const c=l("jet-button"),f=l("jet-label"),w=l("jet-input"),g=l("jet-input-error"),y=l("jet-select-input"),S=l("jet-secondary-button"),v=l("jet-danger-button"),M=l("jet-dialog-modal");return o(),r("div",null,[s.$inertia.page.props.projectPermissions.includes("Manage subscriptions")&&s.showAddbutton?(o(),r("div",A,[t("div",L,[t("div",N,[z,t("span",I,_(s.route("api.create.subscription",{project:s.route().params.project})),1)])]),t("div",null,[a(c,{onClick:e[0]||(e[0]=n=>s.openModal()),class:"float-right w-fit"},{default:i(()=>[u(" Add Subscription ")]),_:1}),F])])):d("",!0),t("div",null,[s.showSuccessMessage?(o(),r("div",G,[s.wantsToUpdate?(o(),r("strong",q,"Subscription updated successfully")):s.wantsToDelete?(o(),r("strong",H,"Subscription deleted successfully")):(o(),r("strong",K,"Subscription created successfully")),t("span",{onClick:e[1]||(e[1]=n=>s.showSuccessMessage=!1),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},R)])):d("",!0),s.showErrorMessage?(o(),r("div",W,[s.wantsToUpdate?(o(),r("strong",X,"Subscription update failed")):s.wantsToDelete?(o(),r("strong",Y,"Subscription delete failed")):(o(),r("strong",Z,"Subscription creation failed")),t("span",{onClick:e[2]||(e[2]=n=>s.showSuccessMessage=!1),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},ss)])):d("",!0),a(M,{show:s.showModal,closeable:!1},{title:i(()=>[s.wantsToUpdate?(o(),r(p,{key:0},[u("Update Subscription")],64)):s.wantsToDelete?(o(),r(p,{key:1},[u("Delete Subscription")],64)):(o(),r(p,{key:2},[u("Add Subscription")],64))]),content:i(()=>[s.wantsToDelete?(o(),r(p,{key:0},[es,t("p",ts,_(s.hasSubscriber?s.subscription.subscriber.msisdn:"Unknown"),1)],64)):(o(),r(p,{key:1},[t("div",os,[a(f,{for:"msisdn",value:"Mobile"}),a(w,{id:"msisdn",type:"text",class:"mt-1 block w-full",modelValue:s.form.msisdn,"onUpdate:modelValue":e[3]||(e[3]=n=>s.form.msisdn=n),placeholder:"26772000001"},null,8,["modelValue"]),a(g,{message:s.form.errors.msisdn,class:"mt-2"},null,8,["message"])]),t("div",rs,[a(f,{for:"subscription-plan",value:"Subscription Plan",class:"mb-1"}),a(y,{placeholder:"Select subscription plan",options:s.subscriptionPlanOptions,modelValue:s.form.subscription_plan_id,"onUpdate:modelValue":e[4]||(e[4]=n=>s.form.subscription_plan_id=n)},null,8,["options","modelValue"]),a(g,{message:s.form.errors.subscription_plan_id,class:"mt-2"},null,8,["message"])])],64))]),footer:i(()=>[a(S,{onClick:e[5]||(e[5]=n=>s.closeModal()),class:"mr-2"},{default:i(()=>[u(" Cancel ")]),_:1}),s.hasSubscription?d("",!0):(o(),m(c,{key:0,onClick:e[6]||(e[6]=b(n=>s.create(),["prevent"])),class:h({"opacity-25":s.form.processing}),disabled:s.form.processing},{default:i(()=>[u(" Create ")]),_:1},8,["class","disabled"])),s.wantsToUpdate?(o(),m(c,{key:1,onClick:e[7]||(e[7]=b(n=>s.update(),["prevent"])),class:h({"opacity-25":s.form.processing}),disabled:s.form.processing},{default:i(()=>[u(" Update ")]),_:1},8,["class","disabled"])):d("",!0),s.wantsToDelete?(o(),m(v,{key:2,onClick:e[8]||(e[8]=b(n=>s.destroy(),["prevent"])),class:h({"opacity-25":s.form.processing}),disabled:s.form.processing},{default:i(()=>[u(" Delete ")]),_:1},8,["class","disabled"])):d("",!0)]),_:1},8,["show"])])])}const Ss=U(P,[["render",ns]]);export{Ss as default};
