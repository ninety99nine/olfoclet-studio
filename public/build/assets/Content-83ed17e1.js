import"./base-c7d9afcb.js";import{E as _}from"./el-popover-9832dd3a.js";import m from"./SubscriptionPlanCanAutoBillBadge-1aa16d6b.js";import x from"./AutoBillingStatusBadge-6a2f6c4a.js";import{P as b}from"./Pagination-999347a1.js";import{s as y,e as o,a as t,g as i,b as l,w as c,F as w,h as f,f as p,x as r,o as a,t as n,i as B}from"./app-430601de.js";import{h as v}from"./moment-fbc5633a.js";import{_ as k}from"./_plugin-vue_export-helper-c27b6911.js";import"./icon-d4413508.js";import"./constants-bf9e3feb.js";/* empty css            */const P=y({components:{Pagination:b,SubscriptionPlanCanAutoBillBadge:m,AutoBillingStatusBadge:x},props:{projectPayload:Object,autoBillingSubscriptionPlansPayload:Object},data(){return{refreshContentInterval:null,subscriptionPlan:null,moment:v}},methods:{refreshContent(){this.$inertia.reload()},getLatestSubscriptionPlanBatchJob(e){return console.log("subscriptionPlan"),console.log(e),console.log("subscriptionPlan.latest_auto_billing_job_batch"),console.log(e.latest_auto_billing_job_batch),console.log("subscriptionPlan.latest_auto_billing_job_batch[0]"),console.log(e.latest_auto_billing_job_batch[0]),e.latest_auto_billing_job_batch.length?e.latest_auto_billing_job_batch[0]:{}},cleanUp(){clearInterval(this.refreshContentInterval),this.refreshContentInterval=null}},created(){this.refreshContentInterval=setInterval(function(){this.refreshContent()}.bind(this),5e3)},unmounted(){this.cleanUp()}}),S={class:"bg-gray-50 border-b pl-6 py-3 rounded-t text-gray-500 text-sm mb-4 flex items-center"},j={key:0,class:"text-gray-400"},A=t("span",{class:"text-green-500 font-bold"},"Auto Billing is enabled",-1),C={key:1,class:"text-gray-400"},L=t("span",{class:"text-red-500 font-bold"},"Auto Billing is disabled",-1),J=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 ml-2",fill:"none",viewBox:"0 0 24 24",strokeWidth:"{1.5}",stroke:"currentColor"},[t("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})],-1),$={key:0,class:"break-normal"},V=t("hr",{class:"my-4"},null,-1),I={key:1,class:"break-normal"},N={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},T={class:"flex flex-col"},D={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},E={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},M={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},z={class:"min-w-full divide-y divide-gray-200"},F=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Name")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Auto Bill")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Status")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Sprints")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-100"},[t("span",null,"Total")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-100"},[t("span",null,"Pending")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-100"},[t("span",null,"Processed")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-100"},[t("span",null,"Progress")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Last Sprint Date")]),t("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Actions")])])],-1),O={class:"bg-white divide-y divide-gray-200"},U={class:"px-6 py-3 whitespace-nowrap"},Y={class:"text-sm text-gray-900"},H={class:"px-6 py-3"},W={class:"px-6 py-3"},q={class:"px-6 py-3 whitespace-nowrap text-sm text-gray-500 text-center"},G={class:"text-sm text-gray-900"},K={class:"px-6 py-3 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},Q={class:"text-sm text-gray-900"},R={class:"px-6 py-3 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},X={class:"text-sm text-gray-900"},Z={class:"px-6 py-3 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},tt={class:"text-sm text-gray-900"},et={class:"px-6 py-3 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},st={class:"text-lg text-green-600"},ot={class:"px-6 py-3 whitespace-nowrap text-sm text-gray-500"},at={class:"px-6 py-3 whitespace-nowrap text-right text-sm font-medium"},nt=["onClick"],it={key:0},lt=t("td",{colspan:10,class:"px-6 py-3 whitespace-nowrap"},[t("div",{class:"text-center text-gray-900 text-sm p-6"},"No subscription plans")],-1),rt=[lt];function ct(e,pt,dt,gt,ut,ht){const d=_,g=r("SubscriptionPlanCanAutoBillBadge"),u=r("AutoBillingStatusBadge"),h=r("pagination");return a(),o("div",null,[t("div",S,[e.projectPayload.can_auto_bill?(a(),o("span",j,[A,i(' — You can turn off "Auto Billing" in settings (This affects all subscription plans)')])):(a(),o("span",C,[L,i(' — You can turn on "Auto Billing" in settings')])),l(d,{width:400},{reference:c(()=>[J]),default:c(()=>[e.projectPayload.can_auto_bill?(a(),o("span",$,[i(` Turning off "Auto Billing" from the project settings means that every subscription plan won't be able to auto bill even if the subscription plan "Auto Billing" option is turned on `),V,i(' After turning off "Auto Billing" from the project settings, any running subscription plans will complete their last sprint before completely stopping to auto bill. ')])):(a(),o("span",I,' Turning on "Auto Billing" from the project settings means that every subscription plan will be able to auto bill as long as the subscription plan "Auto Billing" option is turned on '))]),_:1})]),t("div",N,[t("div",T,[t("div",D,[t("div",E,[t("div",M,[t("table",z,[F,t("tbody",O,[(a(!0),o(w,null,f(e.autoBillingSubscriptionPlansPayload.data,s=>(a(),o("tr",{key:s.id},[t("td",U,[t("div",Y,n(s.name),1)]),t("td",H,[l(g,{subscriptionPlan:s},null,8,["subscriptionPlan"])]),t("td",W,[l(u,{autoBillingSubscriptionPlanJobBatch:e.getLatestSubscriptionPlanBatchJob(s)},null,8,["autoBillingSubscriptionPlanJobBatch"])]),t("td",q,[t("div",G,n(s.auto_billing_job_batches_count),1)]),t("td",K,[t("div",Q,n(e.getLatestSubscriptionPlanBatchJob(s).total_jobs),1)]),t("td",R,[t("div",X,n(e.getLatestSubscriptionPlanBatchJob(s).pending_jobs),1)]),t("td",Z,[t("div",tt,n(e.getLatestSubscriptionPlanBatchJob(s).processed_jobs),1)]),t("td",et,[t("span",st,n(e.getLatestSubscriptionPlanBatchJob(s).progress)+" "+n(e.getLatestSubscriptionPlanBatchJob(s).progress?"%":""),1)]),t("td",ot,n(e.getLatestSubscriptionPlanBatchJob(s).created_at==null?"...":e.moment(e.getLatestSubscriptionPlanBatchJob(s).created_at).format("lll")),1),t("td",at,[e.$inertia.page.props.projectPermissions.includes("View subscription plans")?(a(),o("a",{key:0,href:"#",onClick:B(_t=>e.$inertia.get(e.route("show.auto.billing.subscription.plan.job.batches",{project:e.route().params.project,subscription_plan:s.id})),["prevent"]),class:"text-indigo-600 hover:text-indigo-900 mr-3"},"View",8,nt)):p("",!0)])]))),128)),e.autoBillingSubscriptionPlansPayload.data.length==0?(a(),o("tr",it,rt)):p("",!0)])])])])])]),l(h,{class:"mt-6",paginationPayload:e.autoBillingSubscriptionPlansPayload,updateData:["autoBillingSubscriptionPlansPayload"]},null,8,["paginationPayload"])])])}const jt=k(P,[["render",ct]]);export{jt as default};
