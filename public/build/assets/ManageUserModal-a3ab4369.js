import"./base-715c222f.js";import{E as j}from"./el-divider-fc087610.js";import{s as $,e as a,c as p,w as n,f as u,a as t,b as l,x as d,o,g as i,F as m,t as _,h as C,l as V,m as E,i as f,n as g}from"./app-de0467f4.js";import{_ as T,a as D}from"./TextInput-ffd0ded0.js";import{_ as B}from"./InputLabel-ee6d9ab7.js";import{_ as J}from"./PrimaryButton-59c7c447.js";import{J as O}from"./SelectInput-9be824b1.js";import{a as A}from"./DialogModal-0bcc6872.js";import{_ as L}from"./DangerButton-3a48bd47.js";import{_ as N}from"./ActionMessage-b457393f.js";import{_ as z}from"./SecondaryButton-bd720716.js";import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";const F=$({components:{JetLabel:B,JetInput:T,JetButton:J,JetInputError:D,JetSelectInput:O,JetDialogModal:A,JetSecondaryButton:z,JetActionMessage:N,JetDangerButton:L},props:{action:{type:String,default:"update"},availablePermissions:{type:Array},modelValue:{type:Boolean,default:!1},showAddbutton:{type:Boolean,default:!1},user:{type:Object,default:null},show:{type:Boolean,default:!1}},data(){return{form:null,showModal:this.modelValue,showSuccessMessage:!1,showErrorMessage:!1}},watch:{showModal:{handler:function(e,s){e!=this.modelValue&&this.$emit("update:modelValue",e)}},modelValue:{handler:function(e,s){e!=this.showModal&&(this.showModal=e,this.reset())}}},computed:{hasUser(){return this.user!=null},wantsToUpdate(){return!!(this.hasUser&&this.action=="update")},wantsToDelete(){return!!(this.hasUser&&this.action=="delete")}},methods:{openModal(){this.showModal=!0},closeModal(){this.showModal=!1},create(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.post(route("create-user",{project:route().params.project}),e)},update(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.put(route("update-user",{project:route().params.project,user:this.user.id}),e)},destroy(){var e={preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:s=>{this.handleOnSuccess()},onError:s=>{this.handleOnError()}};this.form.delete(route("delete-user",{project:route().params.project,user:this.user.id}),e)},handleOnSuccess(){this.reset(),this.closeModal(),this.showSuccessMessage=!0,setTimeout(()=>{this.showSuccessMessage=!1},3e3)},handleOnError(){this.showErrorMessage=!0,setTimeout(()=>{this.showErrorMessage=!1},3e3)},reset(){this.form=this.$inertia.form({name:this.hasUser?this.user.name:null,email:this.hasUser?this.user.email:null,permissions:this.hasUser?this.user.pivot.permissions:[]})}},created(){this.reset()}}),W={class:"clear-both"},q={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-6",role:"alert"},G={key:0,class:"font-bold"},H={key:1,class:"font-bold"},K={key:2,class:"font-bold"},P=t("svg",{class:"fill-current h-6 w-6 text-green-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("title",null,"Close"),t("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1),Q=[P],R={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6",role:"alert"},X={key:0,class:"font-bold"},Y={key:1,class:"font-bold"},Z={key:2,class:"font-bold"},x=t("svg",{class:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[t("title",null,"Close"),t("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1),ee=[x],se=t("span",{class:"block mt-6 mb-6"},"Are you sure you want to delete this user?",-1),te={class:"text-sm text-gray-500"},oe={class:"mb-4"},re={class:"mb-4"},ae={class:"mt-10 mb-10"},le=t("span",{class:"font-semibold"},"Permissions",-1),ne={class:"grid grid-cols-2 gap-6"},ie=["value","name","checked"],de=["for"],ue=t("div",null,[t("span",{class:"font-bold mr-2"},"Note:"),t("span",null,"When the user account does not exist, a new account is created. The user can login in using their email and the word"),t("span",{class:"font-bold text-green-600 font-italic mx-2"},"password"),t("span",null,"as their default password. Otherwise if the user already has an existing account, they may use their usual password.")],-1);function me(e,s,pe,ce,he,fe){const c=d("jet-button"),w=d("jet-label"),b=d("jet-input"),h=d("jet-input-error"),y=j,v=d("jet-secondary-button"),k=d("jet-danger-button"),M=d("jet-dialog-modal");return o(),a("div",null,[e.$inertia.page.props.projectPermissions.includes("Manage users")&&e.showAddbutton?(o(),p(c,{key:0,onClick:s[0]||(s[0]=r=>e.openModal()),class:"float-right mb-6"},{default:n(()=>[i(" Add User ")]),_:1})):u("",!0),t("div",W,[e.showSuccessMessage?(o(),a("div",q,[e.wantsToUpdate?(o(),a("strong",G,"User updated successfully")):e.wantsToDelete?(o(),a("strong",H,"User deleted successfully")):(o(),a("strong",K,"User created successfully")),t("span",{onClick:s[1]||(s[1]=r=>e.showSuccessMessage=!1),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},Q)])):u("",!0),e.showErrorMessage?(o(),a("div",R,[e.wantsToUpdate?(o(),a("strong",X,"User update failed")):e.wantsToDelete?(o(),a("strong",Y,"User delete failed")):(o(),a("strong",Z,"User creation failed")),t("span",{onClick:s[2]||(s[2]=r=>e.showSuccessMessage=!1),class:"absolute top-0 bottom-0 right-0 px-4 py-3"},ee)])):u("",!0),l(M,{show:e.showModal,closeable:!1},{title:n(()=>[e.wantsToUpdate?(o(),a(m,{key:0},[i("Update User")],64)):e.wantsToDelete?(o(),a(m,{key:1},[i("Delete User")],64)):(o(),a(m,{key:2},[i("Add User")],64))]),content:n(()=>[e.wantsToDelete?(o(),a(m,{key:0},[se,t("p",te,_(e.user.name),1)],64)):(o(),a(m,{key:1},[t("div",oe,[l(w,{for:"name",value:"Name"}),l(b,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:e.form.name,"onUpdate:modelValue":s[3]||(s[3]=r=>e.form.name=r),placeholder:"John Doe"},null,8,["modelValue"]),l(h,{message:e.form.errors.name,class:"mt-2"},null,8,["message"])]),t("div",re,[l(w,{for:"email",value:"Email"}),l(b,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:e.form.email,"onUpdate:modelValue":s[4]||(s[4]=r=>e.form.email=r),placeholder:"example@gmail.com"},null,8,["modelValue"]),l(h,{message:e.form.errors.email,class:"mt-2"},null,8,["message"])]),t("div",ae,[l(y,{"content-position":"left"},{default:n(()=>[le]),_:1}),l(h,{message:e.form.errors.permissions,class:"mt-2"},null,8,["message"])]),t("div",ne,[(o(!0),a(m,null,C(e.availablePermissions,(r,U)=>(o(),a("div",{key:U,class:"flex items-center"},[V(t("input",{"onUpdate:modelValue":s[5]||(s[5]=S=>e.form.permissions=S),value:r,name:r,type:"checkbox",checked:e.form.permissions.includes(r),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,ie),[[E,e.form.permissions]]),t("label",{for:r,class:"ml-3 block text-sm font-medium text-gray-700"},_(r),9,de)]))),128))]),l(y,{"content-position":"left",class:"mt-10 mb-10"}),ue],64))]),footer:n(()=>[l(v,{onClick:s[6]||(s[6]=r=>e.closeModal()),class:"mr-2"},{default:n(()=>[i(" Cancel ")]),_:1}),e.hasUser?u("",!0):(o(),p(c,{key:0,onClick:s[7]||(s[7]=f(r=>e.create(),["prevent"])),class:g({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:n(()=>[i(" Create ")]),_:1},8,["class","disabled"])),e.wantsToUpdate?(o(),p(c,{key:1,onClick:s[8]||(s[8]=f(r=>e.update(),["prevent"])),class:g({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:n(()=>[i(" Update ")]),_:1},8,["class","disabled"])):u("",!0),e.wantsToDelete?(o(),p(k,{key:2,onClick:s[9]||(s[9]=f(r=>e.destroy(),["prevent"])),class:g({"opacity-25":e.form.processing}),disabled:e.form.processing},{default:n(()=>[i(" Delete ")]),_:1},8,["class","disabled"])):u("",!0)]),_:1},8,["show"])])])}const Ce=I(F,[["render",me]]);export{Ce as default};
