import"./base-3ecad56a.js";import{E as f}from"./el-popover-6dd972aa.js";import b from"./CampaignCanSendSmsBadge-d6b93256.js";import w from"./CampaignStatusBadge-625209d3.js";import{P as v}from"./Pagination-54faa811.js";import C from"./ManageCampaignModal-309c00aa.js";import{s as k,e as a,b as i,a as t,g as p,w as m,F as S,h as P,f as l,x as c,o,t as n,i as d}from"./app-8047a45c.js";import{h as j}from"./moment-fbc5633a.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";import"./icon-be9b5ac7.js";import"./isNil-737ab91a.js";import"./constants-7259abfc.js";import"./el-button-5cc72afb.js";import"./index-d2e11550.js";import"./use-form-item-1833bed3.js";import"./el-divider-b3a9b45e.js";import"./el-switch-783e33e3.js";import"./TextInput-bc6cbde4.js";import"./InputLabel-22fd5c5c.js";import"./Textarea-93bc0975.js";import"./PrimaryButton-8efc2419.js";import"./SelectInput-b01ea32e.js";import"./DialogModal-0a229599.js";import"./DangerButton-569cea3a.js";import"./SecondaryButton-bd238173.js";const M=k({components:{ManageCampaignModal:C,Pagination:v,CampaignCanSendSmsBadge:b,CampaignStatusBadge:w},props:{contentToSendOptions:Array,scheduleTypeOptions:Array,subscriptionPlans:Array,smsCampaignsPayload:Object,projectPayload:Object},data(){return{refreshContentInterval:null,isShowingModal:!1,modalAction:null,campaign:null,moment:j}},methods:{refreshContent(){this.$inertia.reload()},getLatestCampaignBatchJob(e){return e.latest_campaign_batch_job.length?e.latest_campaign_batch_job[0]:{}},showModal(e,r){this.campaign=e,this.modalAction=r,this.isShowingModal=!0},cleanUp(){clearInterval(this.refreshContentInterval),this.refreshContentInterval=null}},created(){this.refreshContentInterval=setInterval(function(){this.refreshContent()}.bind(this),3e3)},unmounted(){this.cleanUp()}}),L={class:"bg-gray-50 border-b pl-6 py-3 rounded-t text-gray-500 text-sm mb-4 flex items-center"},T={key:0,class:"text-gray-400"},$=t("span",{class:"text-green-500 font-bold"},"Sending messages is enabled",-1),J={key:1,class:"text-gray-400"},O=t("span",{class:"text-red-500 font-bold"},"Sending messages is disabled",-1),V=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 ml-2",fill:"none",viewBox:"0 0 24 24",strokeWidth:"{1.5}",stroke:"currentColor"},[t("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})],-1),A={key:0,class:"break-normal"},I=t("hr",{class:"my-4"},null,-1),N={key:1,class:"break-normal"},D={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},E={class:"flex flex-col"},U={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},z={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},F={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},Y={class:"min-w-full divide-y divide-gray-200"},H=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Name")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Send Messages")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Status")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Sprints")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-100"},[t("span",null,"Total")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-100"},[t("span",null,"Pending")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-100"},[t("span",null,"Processed")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-100"},[t("span",null,"Progress")]),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Last Sprint Date")]),t("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("span",null,"Actions")])])],-1),W={class:"bg-white divide-y divide-gray-200"},q={class:"px-6 py-4 whitespace-nowrap"},G={class:"text-sm text-gray-900"},K={class:"px-6 py-4"},Q={class:"px-6 py-4"},R={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center"},X={class:"text-sm text-gray-900"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},tt={class:"text-sm text-gray-900"},et={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},st={class:"text-sm text-gray-900"},at={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},ot={class:"text-sm text-gray-900"},nt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},it={class:"text-lg text-green-600"},rt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},pt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},lt=["onClick"],ct=["onClick"],dt=["onClick"],gt={key:0},mt=t("td",{colspan:7,class:"px-6 py-4 whitespace-nowrap"},[t("div",{class:"text-center text-gray-900 text-sm p-6"},"No campaigns")],-1),ht=[mt];function ut(e,r,xt,yt,_t,ft){const h=c("manage-campaign-modal"),u=f,x=c("CampaignCanSendSmsBadge"),y=c("CampaignStatusBadge"),_=c("pagination");return o(),a("div",null,[i(h,{modelValue:e.isShowingModal,"onUpdate:modelValue":r[0]||(r[0]=s=>e.isShowingModal=s),action:e.modalAction,campaign:e.campaign,subscriptionPlans:e.subscriptionPlans,contentToSendOptions:e.contentToSendOptions,scheduleTypeOptions:e.scheduleTypeOptions},null,8,["modelValue","action","campaign","subscriptionPlans","contentToSendOptions","scheduleTypeOptions"]),t("div",L,[e.projectPayload.can_send_messages?(o(),a("span",T,[$,p(' — You can turn off "Send messages" in settings (This affects all campaigns)')])):(o(),a("span",J,[O,p(' — You can turn on "Send messages" in settings')])),i(u,{width:400},{reference:m(()=>[V]),default:m(()=>[e.projectPayload.can_send_messages?(o(),a("span",A,[p(` Turning off "Send Messages" from the project settings means that every campaign won't be able to send messages even if the campaign "Send Messages" option is turned on `),I,p(' After turning off "Send Messages" from the project settings, any running campaigns will complete their last sprint before completely stopping to send messages. ')])):(o(),a("span",N,' Turning on "Send Messages" from the project settings means that every campaign will be able to send messages as long as the campaign "Send Messages" option is turned on '))]),_:1})]),t("div",D,[t("div",E,[t("div",U,[t("div",z,[t("div",F,[t("table",Y,[H,t("tbody",W,[(o(!0),a(S,null,P(e.smsCampaignsPayload.data,s=>(o(),a("tr",{key:s.id},[t("td",q,[t("div",G,n(s.name),1)]),t("td",K,[i(x,{campaign:s},null,8,["campaign"])]),t("td",Q,[i(y,{campaignBatchJob:e.getLatestCampaignBatchJob(s)},null,8,["campaignBatchJob"])]),t("td",R,[t("div",X,n(s.campaign_batch_jobs_count),1)]),t("td",Z,[t("div",tt,n(e.getLatestCampaignBatchJob(s).total_jobs),1)]),t("td",et,[t("div",st,n(e.getLatestCampaignBatchJob(s).pending_jobs),1)]),t("td",at,[t("div",ot,n(e.getLatestCampaignBatchJob(s).processed_jobs),1)]),t("td",nt,[t("span",it,n(e.getLatestCampaignBatchJob(s).progress)+" "+n(e.getLatestCampaignBatchJob(s).progress?"%":""),1)]),t("td",rt,n(e.getLatestCampaignBatchJob(s).created_at==null?"...":e.moment(e.getLatestCampaignBatchJob(s).created_at).format("lll")),1),t("td",pt,[e.$inertia.page.props.projectPermissions.includes("View sms campaigns")?(o(),a("a",{key:0,href:"#",onClick:d(g=>e.$inertia.get(e.route("show.campaign.job.batches",{project:e.route().params.project,campaign:s.id})),["prevent"]),class:"text-indigo-600 hover:text-indigo-900 mr-3"},"View",8,lt)):l("",!0),e.$inertia.page.props.projectPermissions.includes("Manage sms campaigns")?(o(),a("a",{key:1,href:"#",onClick:d(g=>e.showModal(s,"update"),["prevent"]),class:"text-indigo-600 hover:text-indigo-900 mr-3"},"Edit",8,ct)):l("",!0),e.$inertia.page.props.projectPermissions.includes("Manage sms campaigns")?(o(),a("a",{key:2,href:"#",onClick:d(g=>e.showModal(s,"delete"),["prevent"]),class:"text-red-600 hover:text-red-900"},"Delete",8,dt)):l("",!0)])]))),128)),e.smsCampaignsPayload.data.length==0?(o(),a("tr",gt,ht)):l("",!0)])])])])])]),i(_,{class:"mt-6",paginationPayload:e.smsCampaignsPayload,updateData:["smsCampaignsPayload"]},null,8,["paginationPayload"])])])}const Ht=B(M,[["render",ut]]);export{Ht as default};
