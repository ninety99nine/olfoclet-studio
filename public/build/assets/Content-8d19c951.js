import"./base-cb0b2450.js";import{E as _}from"./el-popover-c421b84d.js";import f from"./CampaignBadge-569a1c12.js";import{P as b}from"./Pagination-b88824d1.js";import w from"./ManageCampaignModal-b929dd42.js";import{s as v,e as a,b as r,a as e,g as p,w as m,F as k,h as C,f as l,x as c,o,t as n,i as d}from"./app-b39f8d8f.js";import{h as P}from"./moment-fbc5633a.js";import{_ as j}from"./_plugin-vue_export-helper-c27b6911.js";import"./icon-41310772.js";import"./constants-8e1af873.js";import"./el-divider-21182103.js";import"./el-switch-67d122a0.js";import"./index-e02383ca.js";import"./TextInput-bd0445b0.js";import"./InputLabel-8798f6b7.js";import"./Textarea-4a6b7eb1.js";import"./PrimaryButton-418ad23c.js";import"./SelectInput-a717632a.js";import"./DialogModal-e4ff3063.js";import"./DangerButton-1d461e9d.js";import"./SecondaryButton-ba111271.js";const S=v({components:{ManageCampaignModal:w,Pagination:b,CampaignBadge:f},props:{contentToSendOptions:Array,scheduleTypeOptions:Array,subscriptionPlans:Array,campaignsPayload:Object,projectPayload:Object},data(){return{refreshContentInterval:null,isShowingModal:!1,modalAction:null,campaign:null,moment:P}},methods:{refreshContent(){this.$inertia.reload()},getLatestCampaignBatchJob(t){return t.latest_campaign_batch_job.length?t.latest_campaign_batch_job[0]:{}},showModal(t,i){this.campaign=t,this.modalAction=i,this.isShowingModal=!0},cleanUp(){clearInterval(this.refreshContentInterval),this.refreshContentInterval=null}},created(){this.refreshContentInterval=setInterval(function(){this.refreshContent()}.bind(this),3e3)},unmounted(){this.cleanUp()}}),M={class:"bg-gray-50 border-b pl-6 py-3 rounded-t text-gray-500 text-sm mb-4 flex items-center"},B={key:0,class:"text-gray-400"},L=e("span",{class:"text-green-500 font-bold"},"Sending messages is enabled",-1),T={key:1,class:"text-gray-400"},$=e("span",{class:"text-red-500 font-bold"},"Sending messages is disabled",-1),J=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 ml-2",fill:"none",viewBox:"0 0 24 24",strokeWidth:"{1.5}",stroke:"currentColor"},[e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})],-1),O={key:0,class:"break-normal"},V=e("hr",{class:"my-4"},null,-1),A={key:1,class:"break-normal"},I={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},N={class:"flex flex-col"},D={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},E={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},U={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},z={class:"min-w-full divide-y divide-gray-200"},F=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e("span",null,"Name")]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e("span",null,"Status")]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-center"},[e("span",null,"Sprints")]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-center bg-indigo-100"},[e("span",null,"Total")]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-center bg-indigo-100"},[e("span",null,"Pending")]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-center bg-indigo-100"},[e("span",null,"Processed")]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-center bg-indigo-100"},[e("span",null,"Progress")]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[e("span",null,"Last Sprint Date")]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-right"},[e("span",null,"Actions")])])],-1),Y={class:"bg-white divide-y divide-gray-200"},H={class:"px-6 py-4 whitespace-nowrap"},W={class:"text-sm text-gray-900"},q={class:"px-6 py-4"},G={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center"},K={class:"text-sm text-gray-900"},Q={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},R={class:"text-sm text-gray-900"},X={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},Z={class:"text-sm text-gray-900"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},te={class:"text-sm text-gray-900"},se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center bg-indigo-50"},ae={class:"text-lg text-green-600"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ne={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ie=["onClick"],re=["onClick"],pe=["onClick"],le={key:0},ce=e("td",{colspan:7,class:"px-6 py-4 whitespace-nowrap"},[e("div",{class:"text-center text-gray-900 text-sm p-6"},"No campaigns")],-1),de=[ce];function ge(t,i,me,he,ue,xe){const h=c("manage-campaign-modal"),u=_,x=c("CampaignBadge"),y=c("pagination");return o(),a("div",null,[r(h,{modelValue:t.isShowingModal,"onUpdate:modelValue":i[0]||(i[0]=s=>t.isShowingModal=s),action:t.modalAction,campaign:t.campaign,subscriptionPlans:t.subscriptionPlans,contentToSendOptions:t.contentToSendOptions,scheduleTypeOptions:t.scheduleTypeOptions},null,8,["modelValue","action","campaign","subscriptionPlans","contentToSendOptions","scheduleTypeOptions"]),e("div",M,[t.projectPayload.can_send_messages?(o(),a("span",B,[L,p(' — You can turn off "Send messages" in settings (This affects all campaigns)')])):(o(),a("span",T,[$,p(' — You can turn on "Send messages" in settings')])),r(u,{width:400},{reference:m(()=>[J]),default:m(()=>[t.projectPayload.can_send_messages?(o(),a("span",O,[p(` Turning off "Send Messages" from the project settings means that every campaign won't be able to send messages even if the campaign "Send Messages" option is turned on `),V,p(' After turning off "Send Messages" from the project settings, any running campaigns will complete their last sprint before completely stopping to send messages. ')])):(o(),a("span",A,' Turning on "Send Messages" from the project settings means that every campaign will be able to send messages as long as the campaign "Send Messages" option is turned on '))]),_:1})]),e("div",I,[e("div",N,[e("div",D,[e("div",E,[e("div",U,[e("table",z,[F,e("tbody",Y,[(o(!0),a(k,null,C(t.campaignsPayload.data,s=>(o(),a("tr",{key:s.id},[e("td",H,[e("div",W,n(s.name),1)]),e("td",q,[r(x,{campaignBatchJob:t.getLatestCampaignBatchJob(s)},null,8,["campaignBatchJob"])]),e("td",G,[e("div",K,n(s.campaign_batch_jobs_count),1)]),e("td",Q,[e("div",R,n(t.getLatestCampaignBatchJob(s).total_jobs),1)]),e("td",X,[e("div",Z,n(t.getLatestCampaignBatchJob(s).pending_jobs),1)]),e("td",ee,[e("div",te,n(t.getLatestCampaignBatchJob(s).processed_jobs),1)]),e("td",se,[e("span",ae,n(t.getLatestCampaignBatchJob(s).progress)+" "+n(t.getLatestCampaignBatchJob(s).progress?"%":""),1)]),e("td",oe,n(t.getLatestCampaignBatchJob(s).created_at==null?"...":t.moment(t.getLatestCampaignBatchJob(s).created_at).format("lll")),1),e("td",ne,[t.$inertia.page.props.projectPermissions.includes("View campaigns")?(o(),a("a",{key:0,href:"#",onClick:d(g=>t.$inertia.get(t.route("show-campaign-job-batches",{project:t.route().params.project,campaign:s.id})),["prevent"]),class:"text-indigo-600 hover:text-indigo-900 mr-3"},"View",8,ie)):l("",!0),t.$inertia.page.props.projectPermissions.includes("Manage campaigns")?(o(),a("a",{key:1,href:"#",onClick:d(g=>t.showModal(s,"update"),["prevent"]),class:"text-indigo-600 hover:text-indigo-900 mr-3"},"Edit",8,re)):l("",!0),t.$inertia.page.props.projectPermissions.includes("Manage campaigns")?(o(),a("a",{key:2,href:"#",onClick:d(g=>t.showModal(s,"delete"),["prevent"]),class:"text-red-600 hover:text-red-900"},"Delete",8,pe)):l("",!0)])]))),128)),t.campaignsPayload.data.length==0?(o(),a("tr",le,de)):l("",!0)])])])])])]),r(y,{class:"mt-6",paginationPayload:t.campaignsPayload,updateData:["campaignsPayload"]},null,8,["paginationPayload"])])])}const Ne=j(S,[["render",ge]]);export{Ne as default};
